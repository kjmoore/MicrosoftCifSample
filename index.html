<html>
<head>
<title>Basic Page</title>
</head>
<body>
<p>Test</p>
<script type="text/javascript">
	window.addEventListener("CIFInitDone", function () {
		console.log("The CIF Framework is now active");
		const initialSession = {
			templateName: "la365_home",
			templateParameters: {
				title: "Live Assist 365 Home",
			},
		};

		window.Microsoft.CIFramework.createSession(initialSession).then(
			(sessionId) => {
				console.log("CSW: Created session:" + sessionId);
			},
			(error) => {
				console.log("CSW: ", error);
			}
		);
	});
	
	const dynamicsApi = document.createElement("script");
	dynamicsApi.setAttribute("src", document.referrer + "/webresources/Widget/msdyn_ciLibrary.js");
	dynamicsApi.setAttribute("data-cifid", "CIFMainLibrary");
	dynamicsApi.setAttribute("data-crmurl", document.referrer);
	document.head.appendChild(dynamicsApi);
	
	console.log("Running the CSW Test code");
</script>
</body>
</html>
